```sql
CREATE TABLE amazon (
    order_id TEXT,
    order_date DATE,
    customer_id TEXT,
    customer_name VARCHAR(100),
    product_id TEXT,
    product_name VARCHAR(100),
    category VARCHAR(50),
    brand VARCHAR(50),
    quantity INT,
    unit_price NUMERIC(10,2),
    discount NUMERIC(10,2),
    tax NUMERIC(10,2),
    shipping_cost NUMERIC(10,2),
    total_amount NUMERIC(12,2),
    payment_method VARCHAR(50),
    order_status VARCHAR(50),
    city VARCHAR(50),
    states VARCHAR(50),
    country VARCHAR(50),
    seller_id TEXT
);
```

-- What is the total revenue generated by each category?
```sql
ALTER TABLE Amazon
ADD COLUMN revenue INT;
```

```sql
UPDATE Amazon
SET revenue = quantity * unit_price;
```

```sql
SELECT 
	category,
	SUM(revenue) AS total_revenue
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC;
```

-- Which brand has the highest total sales amount?
```sql
ALTER TABLE Amazon
ADD COLUMN sales INT;
```

```sql
UPDATE Amazon
SET sales = (quantity * unit_price) - discount;
```

```sql
SELECT
	brand,
	SUM(sales) AS total_sales
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC;
```

-- How does monthly revenue trend change over time?
```sql
ALTER TABLE Amazon
ADD COLUMN month VARCHAR(50);
```

```sql
UPDATE Amazon
SET month = EXTRACT(MONTH FROM order_date);
```

```sql
SELECT 
    TRIM(TO_CHAR(TO_DATE(month::text, 'MM'), 'Month')) AS month_name,
	SUM(revenue)
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC;
```

-- Which city generates the maximum number of orders?
```sql
SELECT
	city,
	COUNT(*) AS order_count
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC;
```

-- What are the top 10 products by total quantity sold?
```sql
SELECT 
	product_name,
	SUM(quantity) AS total_quantity
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```
-- Which payment method is used the most by customers?
```sql
SELECT 
	payment_method,
	COUNT(*),
	ROUND(COUNT(*) * 100.0 / SUM(COUNT(*)) OVER (),2) AS percentage
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC;
```

-- What is the average order value by country?
```sql
SELECT
    country,
    ROUND(AVG(total_amount), 2) AS avg_order_value
FROM amazon
GROUP BY country;
```

-- Which seller generates the highest total revenue?
```sql
SELECT
    seller_id,
    SUM(total_amount) AS total_revenue
FROM amazon
GROUP BY seller_id
ORDER BY total_revenue DESC
LIMIT 1;
```

-- How does discount percentage impact total sales?
```sql
SELECT
    ROUND((discount * 100.0) / (unit_price * quantity), 2) AS discount_percent,
    SUM(total_amount) AS total_sales
FROM amazon
GROUP BY discount_percent
ORDER BY discount_percent;
```

-- What is the order status distribution (Delivered, Cancelled, Returned)?
```sql
SELECT
    order_status,
    COUNT(*) AS total_orders
FROM amazon
GROUP BY order_status;
```

-- Which states have the highest shipping cost on average?
```sql
SELECT
	states,
	AVG(shipping_cost)
FROM Amazon
GROUP BY 1
LIMIT 5;
```      	

-- Who are the top 10 customers by total purchase amount?
```sql
SELECT
	customer_name,
	SUM(total_amount) AS total_amount
FROM Amazon
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```

-- What is the average unit price per product category?
```sql
SELECT
	category,
	AVG(unit_price) AS avg_unit_price
FROM Amazon
GROUP BY 1;
```

-- Which products have high sales but low discounts?
```sql
SELECT
    product_id,
    product_name,
    ROUND(SUM(total_amount), 2) AS total_sales,
    ROUND(AVG(discount), 2) AS avg_discount
FROM amazon
GROUP BY product_id, product_name
HAVING
    SUM(total_amount) >
        (SELECT AVG(total_amount) FROM amazon)
    AND
    AVG(discount) <
        (SELECT AVG(discount) FROM amazon)
ORDER BY total_sales DESC;
```
